Гарантировано не будет работать, если не поместить приложенный текстовый файл в нужное место. Теоретически, убрав код, касающийся сокетов, все должно заработать, но не факт, поскольку я немного менял код без тестирования.